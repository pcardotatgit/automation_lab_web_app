<!DOCTYPE HTML>
<!-- description-->
<html>
	<head>
		<title>FLASK APP GENERATOR</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../static/assets/css/main.css" />
    <script>
        function select_profile() {
            var profile_name = document.getElementById("new_profile").value;
            //alert(profile_name);
            //window.open("/check_xdr?client_id="+client_id+"&client_password="+client_password+"&region="+region);
            window.open("/select_profile?profil_name="+profile_name);
        }
        function popup_window( url, id, width, height )
        {
           //extract the url parameters if any, and pass them to the called html
           var tempvar=document.location.toString(); // fetch the URL string
           var passedparams = tempvar.lastIndexOf("?");
           if(passedparams > -1)
              url += tempvar.substring(passedparams);
          popup = window.open( url, id, 'toolbar=no,scrollbars=yes,location=yes,statusbar=yes,menubar=no,resizable=yes,width=' + width + ',height=' + height + '' );
          popup.focus();
        }
    </script>
	</head>
	<body class="is-preload">
		<!-- Nav -->
			<nav id="nav">
					<li><a href="/">Back to main page</a></li>
                    <li><a href="/tools">Back to tool page</a></li>
                    <li><a href="/logout">log Out</a></li>
                    <li><a href="javascript:popup_window('/page_info?page={{page_name}}&route={{route}}','page_info',700,600);">:</a></li>
				</ul>
			</nav>
 		<!-- create new feed-->
			<article id="create_new_feed" class="wrapper style4">
				<div class="container medium">
					<header>
						<h2>Create a Sighting</h2>
						<p>Create a sighting and store it into your local library</p>
                        <p>Sightings are actually so called events, or detections. They are the alerts generated by detection solutions</p>
					</header>
					<div class="row">
						<div class="col-12">
							<form method="get" action="/go_and_create_sighting_json">
								<div class="row">
									<div class="col-6 col-12-small">
										<input type="text"  id="title" name="title" placeholder="Title" />                                     
									</div>
									<div class="col-6 col-12-small">
                                        <input type="text"  id="source" name="source" placeholder="Source" />
									</div>                                    
									<div class="col-6 col-12-small">
										<select id="confidence" name="confidence">
                                            <option value="High">Confidence High</option>	
                                            <option value="Medium">Confidence Medium</option>
                                            <option value="Low">Confidence Low</option>
                                            <option value="Info">Confidence Info</option>
                                            <option value="Unknow">Confidence Unknown</option>
                                            <option value="None">Confidence None</option>                                            
                                        </select>
									</div>                                     
									<div class="col-6 col-12-small">
										<select id="severity" name="severity">
                                            <option value="Critical">Severity Critical</option>
                                            <option value="High">Severity High</option>	
                                            <option value="Medium">Severity Medium</option>
                                            <option value="Low">Severity Low</option>
                                            <option value="info">Severity Info</option>
                                            <option value="unknow">Severity Unknown</option>
                                            <option value="none">Severity None</option>
                                        </select>
									</div>      
									<div class="col-6 col-12-small">
                                        <h4>Sensor :</h4>
									</div>                                    
									<div class="col-6 col-12-small">
										<select id="sensor" name="sensor">
                                            <option value="endpoint.laptop">endpoint.laptop</option>
                                            <option value="endpoint.pos-terminal">endpoint.pos-termina</option>
                                            <option value="endpoint.printer">endpoint.printer</option>
                                            <option value="endpoint.sensor">endpoint.sensor</option>
                                            <option value="endpoint.server">endpoint.server</option>
                                            <option value="endpoint.smart-meter">endpoint.smart-meter</option>
                                            <option value="endpoint.smart-phone">endpoint.smart-phone</option>
                                            <option value="endpoint.tablet">endpoint.tablet</option>
                                            <option value="endpoint.workstation">endpoint.workstation</option>
                                            <option value="network">network</option>
                                            <option value="network.bridge">network.bridge</option>
                                            <option value="network.firewall">network.firewall</option>
                                            <option value="network.gateway">network.gateway</option>
                                            <option value="network.guard">network.guard</option>
                                            <option value="network.hips">network.hips</option>
                                            <option value="network.hub">network.hub</option>
                                            <option value="network.ids">network.ids</option>
                                            <option value="network.ips">network.ips</option>
                                            <option value="network.modem">network.modem</option>
                                            <option value="network.nic">network.nic</option>
                                            <option value="network.proxy">network.proxy</option>
                                            <option value="network.router">network.router</option>
                                            <option value="network.security_manager">network.security_manager</option>
                                            <option value="network.sense_making">network.sense_making</option>
                                            <option value="network.sensor">network.sensor</option>           
                                            <option value="network.switch">network.switch</option>
                                            <option value="network.vpn">network.vpn</option>
                                            <option value="network.wap">network.wap</option>
                                            <option value="process">process</option>
                                            <option value="process.aaa-server">process.aaa-server</option>
                                            <option value="process.anti-virus-scanner">process.anti-virus-scanner</option>
                                            <option value="process.connection-scanner">process.connection-scanner</option>
                                            <option value="process.directory-service">process.directory-service</option>
                                            <option value="process.dns-server">process.dns-server</option>
                                            <option value="process.email-service">process.email-service</option>
                                            <option value="process.file-scanner">process.file-scanner</option>              
                                            <option value="process.location-service">process.location-service</option>
                                            <option value="process.network-scanner">process.network-scanner</option>
                                            <option value="process.remediation-service">process.remediation-service</option>
                                            <option value="process.reputation-service">process.reputation-service</option>
                                            <option value="process.sandbox">process.sandbox</option>
                                            <option value="process.virtualization-service">process.virtualization-service</option>
                                            <option value="process.vulnerability-scanner">process.vulnerability-scanner</option>                                              
                                        </select>                                        
									</div>                                     
									<div class="col-12">
                                         <input type="text" name="short_description" placeholder="short description" />
									</div>  
                                    <h3>Full Description</h3>                                        
									<div class="col-12">
                                         <textarea name="description" rows="5" cols="33">full description</textarea>
									</div>     
                                    <h3>Observables <a href="javascript:popup_window('/observables_help','page_info',500,200);">( help )</a></h3>
									<div class="col-12">
                                         <textarea name="observables" rows="5" cols="33">List of observables. Observables are every entities contained into the full detection definition. 

observable 1
observable 2
etc..</textarea>
                                    </div>  
                                    <h3>Targets <a href="javascript:popup_window('/targets_help','page_info',500,200);">( help )</a></h3>                                 
									<div class="col-12">
                                         <textarea name="targets" rows="5" cols="33">List of targets.
                                         
target 1
target 2
etc..</textarea>
									</div>       
                                    <h3>Relationships <a href="javascript:popup_window('/relationships_help','page_info',500,200);">( help )</a></h3>                            
									<div class="col-12">
                                         <textarea name="relationships" rows="5" cols="33">List of relationships
                                         
source entity1 -> relation -> destination entity1
source entity2 -> relation -> destination entity2
etc..</textarea>
									</div>                                     
									<div class="col-12">
										<ul class="actions">
                                            <li><input type="submit" value="Create JSON data" class="button small scrolly" /></li>
											<li><input type="reset" value="Clear Form" class="alt" /></li>
										</ul>
									</div>                                    
								</div>
							</form>
						</div>
					</div>
				</div>
			</article>
		<!-- Scripts -->
			<script src="../static/assets/js/jquery.min.js"></script>
			<script src="../static/assets/js/jquery.scrolly.min.js"></script>
            <script src="../static/assets/js/init.js"></script>
			<script src="../static/assets/js/browser.min.js"></script>
			<script src="../static/assets/js/breakpoints.min.js"></script>
			<script src="../static/assets/js/util.js"></script>
			<script src="../static/assets/js/main.js"></script>
	</body>
</html>